#!/usr/bin/env php
<?php
/**
 * 辅助命令管理
 * @author donknap
 * @date 18-7-18 下午6:35
 */

$path = end($argv);
reset($argv);
$appPath = null;
if (strpos($path, '--app-path') !== false) {
	$appPath = $path;
	array_pop($argv);
	$_SERVER['argv'] = $argv;
}

$dir = dirname(__DIR__, 4);
if (!file_exists($dir . '/config/define.php')) {
	if (!$appPath) {
		echo '请通过参数--app-path指定app目录';
		exit();
	}
	$dir = explode('=', $appPath, 2)[1];
}

require_once $dir . '/config/define.php';
$loader = require_once BASE_PATH . '/vendor/autoload.php';

$app = \W7\App::getApp();
$app->runConsole();
